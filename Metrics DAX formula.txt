Overview for Insight and Visual creation steps :
---------------------------------------------------------------------------------------------------------------------------

1ï¸âƒ£ Understand the Data Model (from your file)
Sheets in your file

Club Table â†’ Club master data

Members â†’ Member details (join date, status, club)

Checkins â†’ Member visit records (no explicit â€œcountâ€ column)

POS Transactions â†’ Revenue transactions

Profit Centers â†’ Mapping for POS

Metrics â†’ Business questions / KPIs (THIS drives visuals)

2ï¸âƒ£ Metrics Sheet â†’ What needs to be built

From the Metrics sheet, KPIs are grouped into:

ğŸ”¹ Checkins

Total Checkins

Avg Checkins by Member

Checkins by Club

Avg Checkins by Club

ğŸ”¹ Members

Current Active Members

New Members

Cancelled Members

ğŸ”¹ POS Transactions

Total Revenue

Revenue by Club

3ï¸âƒ£ Data Relationships (Excel & Power BI)
Required Relationships
From Table	Column	To Table	Column
Members	Member_ID	Checkins	Member_ID
Members	Club_ID	Club Table	Club_ID
POS Transactions	Club_ID	Club Table	Club_ID
POS Transactions	Profit_Center_ID	Profit Centers	Profit_Center_ID

ğŸ“Œ This is mandatory in Power BI
ğŸ“Œ In Excel, youâ€™ll simulate this via Pivot Tables / XLOOKUP

4ï¸âƒ£ Excel Calculations (Step-by-Step)
ğŸ”¹ CHECKINS METRICS (Excel)
âœ… Total Checkins

Logic:
Each row in Checkins = 1 check-in

Excel Formula

=COUNTA(Checkins!A:A)

(or use a Pivot Table â†’ Count of Member_ID)

âœ… Avg Checkins by Member

Logic:
Total Checkins Ã· Distinct Members who checked in

Formula

= Total_Checkins / COUNTA(UNIQUE(Checkins!Member_ID))
âœ… Checkins by Club

Logic:
Count checkins grouped by club

Steps

Add Club_ID to Checkins using XLOOKUP from Members

Create Pivot Table:

Rows â†’ Club Name

Values â†’ Count of Member_ID

âœ… Avg Checkins by Club

Logic:
Checkins per club Ã· Members in that club

Formula

= Checkins_per_Club / Total_Members_in_Club
ğŸ”¹ MEMBERS METRICS (Excel)
âœ… Current Active Members

Logic:
Members where Status = "Active"

Formula

=COUNTIF(Members!Status, "Active")
âœ… New Members

Logic:
Members joined in selected period (month/year)

Example (current month)

=COUNTIFS(Members!StartDate,">="&EOMONTH(TODAY(),-1)+1,
          Members!StartDate,"<="&EOMONTH(TODAY(),0))
âœ… Cancelled Members
=COUNTIF(Members!Status,"Cancelled")
ğŸ”¹ POS METRICS (Excel)
âœ… Total Revenue
=SUM('POS Transactions'!Amount)
âœ… Revenue by Club

Steps

Pivot Table

Rows â†’ Club Name

Values â†’ Sum of Amount

5ï¸âƒ£ Power BI â€“ Step-by-Step Build
ğŸ”¹ Step 1: Load Data

Open Power BI Desktop

Get Data â†’ Excel â†’ Load all sheets

ğŸ”¹ Step 2: Create Relationships

Go to Model View and create relationships as described above.

ğŸ”¹ Step 3: DAX Calculations (VERY IMPORTANT)
ğŸŸ¢ Checkins Measures
Total Checkins =
COUNTROWS(Checkins)
Distinct Members Checked In =
DISTINCTCOUNT(Checkins[Member_ID])
Avg Checkins by Member =
DIVIDE([Total Checkins], [Distinct Members Checked In])
Checkins by Club =
COUNT(Checkins[Member_ID])
Avg Checkins by Club =
DIVIDE([Total Checkins], DISTINCTCOUNT(Members[Member_ID]))
ğŸŸ¢ Members Measures
Active Members =
CALCULATE(
    COUNT(Members[Member_ID]),
    Members[Status] = "Active"
)
Cancelled Members =
CALCULATE(
    COUNT(Members[Member_ID]),
    Members[Status] = "Cancelled"
)
New Members =
CALCULATE(
    COUNT(Members[Member_ID]),
    FILTER(
        Members,
        Members[StartDate] >= MIN('Date'[Date]) &&
        Members[StartDate] <= MAX('Date'[Date])
    )
)
ğŸŸ¢ POS Measures
Total Revenue =
SUM('POS Transactions'[Amount])
Revenue by Club =
SUM('POS Transactions'[Amount])
6ï¸âƒ£ Recommended Data Visuals (From Metrics Sheet)
Metric	Visual
Total Checkins	Card
Avg Checkins by Member	Card
Checkins by Club	Clustered Column Chart
Avg Checkins by Club	Bar Chart
Active Members	Card
New Members	Line Chart (by month)
Cancelled Members	Card
Total Revenue	Card
Revenue by Club	Column / Tree Map
7ï¸âƒ£ Final Dashboard Layout (Best Practice)
ğŸ”¹ Top KPIs (Cards)

Total Checkins

Active Members

Total Revenue

ğŸ”¹ Middle Section

Checkins by Club

Revenue by Club

ğŸ”¹ Bottom Section

New vs Cancelled Members trend

Avg Checkins per Member

---------------------------------------------------------------------------------------------------------------------------
1ï¸âƒ£ Metrics Sheet â†’ Fact, Dimension & Hybrid Classification

Based on the Metrics sheet KPIs, your data model should look like this:

ğŸ”· FACT TABLES (Transactional / Measurable)

These answer â€œhow much / how many / whenâ€

âœ… Fact_Checkins

Source: Checkins sheet
Grain: One row per member check-in

Column	Description
Checkin_ID (if exists)	Unique checkin
Member_ID	Who checked in
Checkin_Date	When
Club_ID	Where

Metrics Derived

Total Checkins

Avg Checkins per Member

Checkins by Club

âœ… Fact_POS_Transactions

Source: POS Transactions sheet
Grain: One row per transaction

Column	Description
Transaction_ID	
Club_ID	
Profit_Center_ID	
Transaction_Date	
Amount	

Metrics Derived

Total Revenue

Revenue by Club

ğŸ”· DIMENSION TABLES (Descriptive)

These answer â€œwho / what / whereâ€

âœ… Dim_Members

Source: Members sheet

Column
Member_ID
Member_Name
Gender
StartDate
Status
Club_ID
âœ… Dim_Club

Source: Club Table

Column
Club_ID
Club_Name
Location
âœ… Dim_Profit_Center

Source: Profit Centers

Column
Profit_Center_ID
Profit_Center_Name
âœ… Dim_Date (must be created)

Used for:

New Members

Trends

Monthly visuals

ğŸ”· HYBRID TABLE (Fact + Dimension behavior)
âš ï¸ Hybrid: Members Table

The Members table behaves as:

Dimension â†’ member attributes

Fact-like â†’ counts for:

Active Members

Cancelled Members

New Members

ğŸ“Œ This is explicitly implied by the Metrics sheet

2ï¸âƒ£ STAR SCHEMA (Target Model)
            Dim_Date
                |
Dim_Club â€” Fact_Checkins â€” Dim_Members
                |
        Fact_POS_Transactions
                |
        Dim_Profit_Center

3ï¸âƒ£ STEP-BY-STEP: EXCEL IMPLEMENTATION
ğŸ”¹ STEP 1: Prepare Fact Tables
Fact_Checkins (Excel)

Each row = 1 check-in

Add:

Club_ID = XLOOKUP(Member_ID, Members!Member_ID, Members!Club_ID)
Fact_POS_Transactions

Already transactional â†’ no change

ğŸ”¹ STEP 2: Dimension Tables

Use unique lists:

Club Table

Members

Profit Centers

Date table (manually or formula)

ğŸ”¹ STEP 3: Excel Calculations (By Fact / Dimension)
ğŸŸ¢ FACT: CHECKINS
Total Checkins
=COUNTA(Fact_Checkins!Member_ID)
Avg Checkins per Member
=COUNTA(Fact_Checkins!Member_ID) /
 COUNTA(UNIQUE(Fact_Checkins!Member_ID))
Checkins by Club

Pivot Table:

Rows â†’ Club_Name

Values â†’ Count of Member_ID

ğŸŸ¢ FACT: POS TRANSACTIONS
Total Revenue
=SUM(Fact_POS_Transactions!Amount)
Revenue by Club

Pivot:

Rows â†’ Club_Name

Values â†’ Sum of Amount

ğŸŸ¢ HYBRID: MEMBERS
Active Members
=COUNTIF(Members!Status,"Active")
Cancelled Members
=COUNTIF(Members!Status,"Cancelled")
New Members (Monthly)
=COUNTIFS(
 Members!StartDate,">="&StartDate,
 Members!StartDate,"<="&EndDate
)
4ï¸âƒ£ STEP-BY-STEP: POWER BI IMPLEMENTATION
ğŸ”¹ STEP 1: Load Tables

Load:

Checkins

POS Transactions

Members

Club Table

Profit Centers

ğŸ”¹ STEP 2: Create Date Table (MANDATORY)
Dim_Date =
ADDCOLUMNS(
    CALENDAR (DATE(2018,1,1), DATE(2026,12,31)),
    "Year", YEAR([Date]),
    "Month", FORMAT([Date],"MMM"),
    "MonthYear", FORMAT([Date],"MMM YYYY")
)
ğŸ”¹ STEP 3: Create Relationships
From	To
Checkins[Member_ID] â†’ Members[Member_ID]	
Members[Club_ID] â†’ Club[Club_ID]	
POS[Club_ID] â†’ Club[Club_ID]	
POS[Profit_Center_ID] â†’ Profit_Center	
Date[Date] â†’ Checkins[Checkin_Date]	
Date[Date] â†’ Members[StartDate]	
Date[Date] â†’ POS[Transaction_Date]	
5ï¸âƒ£ POWER BI â€“ DAX CALCULATIONS (By Table Type)
ğŸŸ¢ FACT: CHECKINS
Total Checkins =
COUNTROWS(Checkins)
Distinct Members Checked In =
DISTINCTCOUNT(Checkins[Member_ID])
Avg Checkins per Member =
DIVIDE([Total Checkins],[Distinct Members Checked In])
Checkins by Club =
COUNT(Checkins[Member_ID])
ğŸŸ¢ FACT: POS TRANSACTIONS
Total Revenue =
SUM('POS Transactions'[Amount])
Revenue by Club =
SUM('POS Transactions'[Amount])
ğŸŸ¢ HYBRID: MEMBERS
Active Members =
CALCULATE(
    COUNT(Members[Member_ID]),
    Members[Status] = "Active"
)
Cancelled Members =
CALCULATE(
    COUNT(Members[Member_ID]),
    Members[Status] = "Cancelled"
)
New Members =
CALCULATE(
    COUNT(Members[Member_ID]),
    USERELATIONSHIP(Members[StartDate], Dim_Date[Date])
)
6ï¸âƒ£ Visual Mapping (Metrics Sheet â†’ BI Visuals)
Metric	Table Type	Visual
Total Checkins	Fact	Card
Avg Checkins	Fact	Card
Checkins by Club	Fact + Dim	Column
Active Members	Hybrid	Card
New Members	Hybrid + Date	Line
Cancelled Members	Hybrid	Card
Total Revenue	Fact	Card
Revenue by Club	Fact + Dim	Bar
---------------------------------------------------------------------------------------------------------------------------

DAX formula to create a calculated column for Transaction_ID:

Transaction_ID =
RANKX(
    ALL('POS Transactions'),
    'POS Transactions'[Transaction_Date] & 
    'POS Transactions'[Club_ID] & 
    'POS Transactions'[Amount],
    ,
    ASC,
    DENSE
)

Excel Method :

Add a column:

Transaction_ID = ROW() - 1

DAX Formula for Total Revenue & Transactions :
Total Revenue = SUM(subtotal)
Total Transactions = COUNTROWS('POS Transactions')

---------------------------------------------------------------------------------------------------------------------------

1ï¸âƒ£ DATA MODEL (Must be correct first)
Tables

Fact tables

Checkins

POS Transactions

Dimension tables

Members

Club

Dim_Date (created earlier)

Relationships
Checkins[Member_ID] â†’ Members[Member_ID]
POS[Member_ID]      â†’ Members[Member_ID]
Members[Club_ID]    â†’ Club[Club_ID]

Checkins[Date]      â†’ Dim_Date[Date]  (Active)
POS[Date]           â†’ Dim_Date[Date]  (Active)
Members[StartDate]  â†’ Dim_Date[Date]  (Inactive)
2ï¸âƒ£ REQUIRED MEASURES (Create once)
Activity
Total Checkins =
COUNTROWS(Checkins)

Distinct Members =
DISTINCTCOUNT(Members[Member_ID])

Avg Checkins per Member =
DIVIDE([Total Checkins], [Distinct Members])
Membership
New Members =
CALCULATE(
    COUNT(Members[Member_ID]),
    USERELATIONSHIP(Members[StartDate], Dim_Date[Date])
)

Active Members =
CALCULATE(
    DISTINCTCOUNT(Checkins[Member_ID])
)
Revenue
Total Revenue =
SUM('POS Transactions'[Subtotal])
3ï¸âƒ£ DASHBOARD LAYOUT (Follow This Structure)

Think of the dashboard as 4 rows

ğŸ”¹ ROW 1 â€” KPI SUMMARY CARDS

Add Card visuals

KPI	Measure
Total Revenue	Total Revenue
Total Checkins	Total Checkins
Active Members	Active Members
New Members	New Members

ğŸ“Œ This gives instant business health overview

ğŸ”¹ ROW 2 â€” TRENDS (Time Intelligence)
Visual 1 â€” Checkins Trend

Line Chart

X-axis â†’ Dim_Date[Month Year]

Values â†’ Total Checkins

Legend â†’ Club Name

Visual 2 â€” Revenue Trend

Line Chart

X-axis â†’ Month Year

Values â†’ Total Revenue

Legend â†’ Club Name

Visual 3 â€” New Members Trend

Area Chart

X-axis â†’ Month Year

Values â†’ New Members

ğŸ”¹ ROW 3 â€” CLUB PERFORMANCE
Visual 4 â€” Avg Checkins by Club

Bar Chart

Axis â†’ Club Name

Values â†’ Avg Checkins per Member

Visual 5 â€” Revenue by Club

Bar Chart

Axis â†’ Club Name

Values â†’ Total Revenue

Visual 6 â€” Active Members by Club

Bar Chart

Axis â†’ Club Name

Values â†’ Active Members

ğŸ”¹ ROW 4 â€” ENGAGEMENT ANALYSIS
Visual 7 â€” Visit Frequency Distribution

Column Chart
(Create bins from checkins per member)

Visual 8 â€” Top Members (Optional)

Table:

Member_ID

Club

Total Checkins

Revenue

4ï¸âƒ£ ADD INTERACTIVITY (Very Important)

Add slicers:

Slicer	Column
Date	Dim_Date[Date]
Club	Club[Club_Name]
Payment Type	POS[PaymentType]
Weekend/Weekday	Dim_Date[Is Weekend]

Now entire dashboard filters dynamically.

---------------------------------------------------------------------------------------------------------------------------

Excel Formula :
âœ… OPTION 3: Start & End Date via Helper Cells (BEST PRACTICE)
Helper cells
B1 = DATE(YEAR(TODAY()),MONTH(TODAY()),1)
B2 = EOMONTH(B1,0)
Formula
=COUNTIFS(
    Members!StartDate,">="&B1,
    Members!StartDate,"<="&B2
)

Relationship Diagram :

                Dim_Date
                   |
                   | (Date)
                   |
        --------------------------------
        |                              |
Fact_POS_Transactions        Fact_Checkins
        |                              |
        | (Member_ID)                  | (Member_ID)
        |                              |
   Dim_Members                     Dim_Members
        |
        | (Club_ID)
        |
     Dim_Clubs
        |
        | (Profit_Center)
        |
 Dim_Profit_Centers

--------------------------------------------------------------------------------------------------------------------------
Steps followed to build visuals for Member Acquisition and Cancellation Overtime :

1ï¸âƒ£ Member Status Column (like Python logic)
Member Status =
VAR TodayDate = TODAY()
RETURN
IF(
    ISBLANK(Members[StatusDate]),
    "Active",
    IF(Members[StatusDate] >= TodayDate, "Pending Cancel", "Expired")
)
2ï¸âƒ£ Join Month & Cancel Month
Join Month = DATE(YEAR(Members[JoinDate]), MONTH(Members[JoinDate]), 1)

Cancel Month =
IF(
    ISBLANK(Members[StatusDate]),
    BLANK(),
    DATE(YEAR(Members[StatusDate]), MONTH(Members[StatusDate]), 1)
)
ğŸ§© STEP 5 â€” Create Measures
Members Joined
Members Joined = COUNT(Members[MemberKey])
Members Cancelled
Members Cancelled =
CALCULATE(
    COUNT(Members[MemberKey]),
    NOT(ISBLANK(Members[StatusDate]))
)
Total Visits
Total Visits = COUNT(Checkins[CheckinID])
Revenue
Total Revenue = SUM(Transactions[Amount])
Visits per Member
Visits per Member =
DIVIDE([Total Visits], DISTINCTCOUNT(Members[MemberKey]))
ğŸ“Š VISUAL 1 â€” Member Join vs Cancel Trend
Create Date Table (Required for continuous axis)

Modeling â†’ New Table

Calendar =
ADDCOLUMNS(
    CALENDAR (DATE(2018,1,1), DATE(2025,12,31)),
    "Year", YEAR([Date]),
    "Month Number", MONTH([Date]),
    "Month", FORMAT([Date],"MMM"),
    "YearMonth", FORMAT([Date],"YYYY-MM")
)
Add:

MonthYear = FORMAT(Calendar[Date], "MMM YYYY")
MonthStart = DATE(YEAR(Calendar[Date]), MONTH(Calendar[Date]), 1)

Create TWO relationships:

From	To	Active?
Calender[Date]	Members[JoinDate]	âœ… Active
Calender[Date]	Members[CancelDate / StatusDate]	âŒ Inactive

(Set second as inactive)

Measures using USERELATIONSHIP
Joined Members =
DISTINCTCOUNT(Members[Member_Key])

Cancelled Members =
CALCULATE(
    DISTINCTCOUNT(Members[Member_Key]),
    USERELATIONSHIP(Members[StatusDate], 'Date'[Date])
)
Build Chart

Insert â†’ Clustered Column Chart

Fields:

X Axis â†’ Calendar[MonthStart]
Values â†’ Joined, Cancelled

Axis Type â†’ Continuous

You now reproduced chart 1 ğŸ¯

ğŸ“Š VISUAL 2 â€” Member Status Distribution (Pie)

Insert â†’ Pie Chart

Fields:

Legend â†’ Member Status
Values â†’ Count of MemberKey

Format â†’ Show Percentages ON

Matches your Python pie chart âœ”

ğŸ“Š VISUAL 3 â€” Visits per Member Distribution (Histogram)

Power BI doesnâ€™t auto-histogram â†’ create bins

Go to Checkins table

Right click â†’ MemberKey â†’ New Group

Bin size: 1

Then create measure:

Visit Count = COUNT(Checkins[CheckinID])

Insert â†’ Column chart

X-axis â†’ Visit Count bins
Y-axis â†’ Count of Members

Now matches your distribution plot âœ”

ğŸ“Š VISUAL 4 â€” Top 10 Members by Spending

Insert â†’ Bar Chart

Y Axis â†’ MemberKey
X Axis â†’ Total Revenue

Filters â†’ Top N â†’ 10 â†’ By Total Revenue

Sort descending

---------------------------------------------------------------------------------------------------------------------------
ğŸ¯ Objective

Show how many members fall into visit frequency groups like:

0â€“5 visits

6â€“10 visits

11â€“20 visits

21+ visits

âœ… STEP 1: Create Visits Per Member Measure

First, calculate total visits per member.

ğŸ”¹ If you already have Checkins table:

Go to Model View â†’ Ensure:

Members[MemberKey]  â†’  Checkins[MemberKey]
(Relationship: One-to-Many)
ğŸ”¹ Create Measure (DAX)

Go to Modeling â†’ New Measure

Visits per Member = 
CALCULATE(
    COUNT(Checkins[CheckinDate]),
    ALLEXCEPT(Members, Members[MemberKey])
)

This calculates total check-ins for each member.

âœ… STEP 2: Create Histogram Bins (Very Important)

Power BI does not automatically create histograms for measures.

So we create bins using a calculated column.

ğŸ”¹ Option A (Recommended for Interviews) â€“ Create Visit Groups

Go to Modeling â†’ New Column in Members table:

Visit Group = 
SWITCH(
    TRUE(),
    [Visits per Member] = 0, "0 Visits",
    [Visits per Member] <= 5, "1-5 Visits",
    [Visits per Member] <= 10, "6-10 Visits",
    [Visits per Member] <= 20, "11-20 Visits",
    "21+ Visits"
)
âœ… STEP 3: Create Histogram Visual
ğŸ¨ Create Visual

Go to Report View

Select Clustered Column Chart

Drag fields:

Field	Put In
Visit Group	X-Axis
MemberKey	Values

Change Values aggregation to:

Count (Distinct)
ğŸ“Š Final Visual Looks Like This
Members Count
   |
   |                â–ˆâ–ˆâ–ˆâ–ˆ
   |        â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
   |  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
   |________________________________
     0    1-5    6-10   11-20  21+
            Visit Groups

ğŸ‘‰ X-axis = Visit Frequency Groups
ğŸ‘‰ Y-axis = Number of Members

Create measure:

Average Visits = 
AVERAGEX(
    VALUES(Members[MemberKey]),
    [Visits per Member]
)

Add as KPI card.